<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Catch 20 to Win</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body {
    margin: 0;
    background: #111;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: sans-serif;
    color: #fff;
    flex-direction: column;
  }
  canvas {
    background: linear-gradient(#223, #000);
    border: 2px solid #fff;
    border-radius: 8px;
    touch-action: none;
  }
  #overlay {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%,-50%);
    color: #fff;
    font-size: 24px;
    text-align: center;
    display: none;
  }
  .controls {
    display: flex;
    gap: 20px;
    margin-top: 12px;
  }
  .btn {
    background: #333;
    color: #fff;
    padding: 14px 24px;
    border-radius: 10px;
    font-size: 20px;
    user-select: none;
  }
  .btn:active {
    background: #666;
  }
</style>
</head>
<body>
<canvas id="game" width="400" height="600"></canvas>
<div id="overlay"></div>
<div class="controls">
  <div class="btn" id="leftBtn">‚óÄ</div>
  <div class="btn" id="rightBtn">‚ñ∂</div>
  <div class="btn" id="restartBtn">‚ü≥</div>
</div>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const overlay = document.getElementById("overlay");
const leftBtn = document.getElementById("leftBtn");
const rightBtn = document.getElementById("rightBtn");
const restartBtn = document.getElementById("restartBtn");

// player (basket)
const player = {x: 160, y: 560, w: 80, h: 20, speed: 5};

// stars
let stars = [];
let score = 0;
let missed = 0;
let running = true;

function spawnStar() {
  const x = Math.random() * (canvas.width - 20);
  stars.push({x, y: -20, size: 20, speed: 3});
}

function resetGame() {
  stars = [];
  score = 0;
  missed = 0;
  running = true;
  overlay.style.display = "none";
  player.x = 160;
  loop();
}

function endGame(message) {
  running = false;
  overlay.innerHTML = message + "<br><br>Press ‚ü≥ or Space to Restart";
  overlay.style.display = "block";
}

function update() {
  // move player
  if (keys["ArrowLeft"] || keys["a"] || touchLeft) player.x -= player.speed;
  if (keys["ArrowRight"] || keys["d"] || touchRight) player.x += player.speed;
  if (player.x < 0) player.x = 0;
  if (player.x + player.w > canvas.width) player.x = canvas.width - player.w;

  // move stars
  for (let i = stars.length - 1; i >= 0; i--) {
    let s = stars[i];
    s.y += s.speed;
    if (s.y > canvas.height) {
      stars.splice(i,1);
      missed++;
    }
    // collision
    if (
      s.x < player.x + player.w &&
      s.x + s.size > player.x &&
      s.y < player.y + player.h &&
      s.y + s.size > player.y
    ) {
      stars.splice(i,1);
      score++;
    }
  }

  // win/lose condition
  if (score >= 20) endGame("üéâ You Win!");
  if (missed >= 5) endGame("üíÄ You Lose!");
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // draw player
  ctx.fillStyle = "#0f0";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // draw stars
  ctx.fillStyle = "#ff0";
  for (let s of stars) {
    ctx.beginPath();
    ctx.arc(s.x+10, s.y+10, s.size/2, 0, Math.PI*2);
    ctx.fill();
  }

  // score display
  ctx.fillStyle = "#fff";
  ctx.font = "18px sans-serif";
  ctx.fillText("Score: " + score, 10, 20);
  ctx.fillText("Missed: " + missed, 300, 20);
}

function loop() {
  if (!running) return;
  update();
  draw();
  requestAnimationFrame(loop);
}

// spawn stars every 1.2s
setInterval(()=>{ if(running) spawnStar(); }, 1200);

// input
let keys = {};
let touchLeft = false;
let touchRight = false;

window.addEventListener("keydown", e=>{
  keys[e.key] = true;
  if (!running && e.code === "Space") resetGame();
});
window.addEventListener("keyup", e=> keys[e.key] = false);

// touch buttons
leftBtn.addEventListener("touchstart", ()=> touchLeft = true);
leftBtn.addEventListener("touchend", ()=> touchLeft = false);
rightBtn.addEventListener("touchstart", ()=> touchRight = true);
rightBtn.addEventListener("touchend", ()=> touchRight = false);
restartBtn.addEventListener("click", ()=> resetGame());

// also mouse for desktop
leftBtn.addEventListener("mousedown", ()=> touchLeft = true);
leftBtn.addEventListener("mouseup", ()=> touchLeft = false);
rightBtn.addEventListener("mousedown", ()=> touchRight = true);
rightBtn.addEventListener("mouseup", ()=> touchRight = false);

loop();
</script>
</body>
</html>